# مدیریت بارکد و RFID (Asset Tagging System)

**مسیر دسترسی:** `دارایی ثابت > پیکربندی > تنظیمات چاپ و لیبل`
**نام فنی:** `AssetIdentificationSystem`

## ۱. مقدمه و فلسفه وجودی

در سیستم‌های مدرن، تایپ کردن دستی شماره اموال منسوخ شده است.
هدف این ماژول تبدیل **«پلاک اموال»** (یک رشته متنی در دیتابیس) به یک **«فرمت قابل خواندن توسط ماشین»** (Machine-Readable) است.

ERP تابان از دو تکنولوژی اصلی پشتیبانی می‌کند:

1.  **بارکد (Barcode/QR):** ارزان، ساده، اما نیازمند "دید مستقیم" (Line of Sight) برای اسکن.
2.  **RFID (Radio Frequency Identification):** گران‌تر، پیشرفته، با قابلیت اسکن از راه دور و بدون نیاز به دید مستقیم (خواندن ۱۰۰ کالا در ۳ ثانیه).

-----

## ۲. استانداردهای مورد پشتیبانی

### ۲-۱. بارکد دو بعدی (QR Code) - پیشنهاد پیش‌فرض

چرا QR کد بهتر از بارکد خطی (میله‌ای) است؟

  * **ظرفیت بالا:** می‌تواند علاوه بر شماره پلاک، نام دارایی، تاریخ خرید و لینک URL کاردکس را هم در خود ذخیره کند.
  * **تحمل خرابی:** اگر ۳۰٪ برچسب پاره یا مخدوش شود، باز هم قابل خواندن است.
  * **اسکن با موبایل:** برای خواندن آن نیازی به دستگاه گران‌قیمت نیست؛ هر گوشی موبایلی آن را می‌خواند.

### ۲-۲. تگ‌های RFID (استاندارد UHF Gen2)

مخصوص سازمان‌های بزرگ یا محیط‌های صنعتی.

  * **تگ‌های فلزی (Mount-on-Metal):** برای دارایی‌های فلزی (مثل سرورها یا ماشین‌آلات) باید از تگ‌های خاص ضخیم استفاده شود.
  * **کدگذاری (EPC):** شناسه دارایی (`AssetID`) باید به فرمت هگزادسیمال (Hex) تبدیل شده و در حافظه `EPC` تگ نوشته شود.

-----

## ۳. طراحی قالب لیبل (Label Designer)

این بخش به ادمین سیستم اجازه می‌دهد ظاهر برچسب اموال را طراحی کند.
سیستم تابان باید یک **Designer** داشته باشد (یا از فرمت‌های استاندارد پشتیبانی کند).

### اجزای یک لیبل استاندارد:

1.  **لوگوی سازمان:** (بالا راست).
2.  **نام سازمان:** (مثلاً: "وزارت نیرو - اداره کل برق").
3.  **عنوان دارایی:** (مثلاً: "صندلی گردان نیلپر").
4.  **شماره پلاک (خوانا):** متن درشت برای خواندن با چشم (مثلاً `1403-IT-505`).
5.  **ناحیه بارکد/QR:** جهت اسکن.
6.  **هشدار:** (مثلاً: "اموال دولتی - غیرقابل فروش").

> **نکته دولتی (سادا):** در بخش دولتی، درج عبارت "اموال دولتی" و استفاده از فرمت ۱۴ رقمی بارکد الزامی است.

-----

## ۴. فرآیند چاپ و تخصیص (Printing & Commissioning)

چاپ لیبل در ERP تابان صرفاً ارسال یک دستور به پرینتر نیست؛ بلکه یک فرآیند کنترلی است.

### سناریوی چاپ:

1.  **انتخاب:** کاربر در لیست دارایی‌ها، ۱۰ ردیف را انتخاب می‌کند.
2.  **تنظیمات چاپ:**
      * انتخاب پرینتر (مثلاً `Zebra ZT410` در اتاق سرور).
      * انتخاب قالب (مثلاً "قالب استاندارد ۵\*۳ سانت").
3.  **دستور چاپ:** سیستم کد `ZPL` (زبان پرینترهای زبرا) را تولید و ارسال می‌کند.

### سناریوی RFID (نوشتن روی تگ):

در RFID، پرینتر علاوه بر چاپ روی لیبل، باید اطلاعات را **درون چیپ** هم بنویسد (Encode).

  * اگر نوشتن روی چیپ با خطا مواجه شود، پرینتر به صورت خودکار روی لیبل عبارت `VOID` را چاپ می‌کند تا کاربر آن را دور بیندازد.

-----

## ۵. سخت‌افزار و یکپارچگی (Hardware Integration)

ERP تابان برای ارتباط با سخت‌افزار از یک سرویس واسط به نام **`Taban Print Agent`** استفاده می‌کند که روی کامپیوتر کلاینت نصب می‌شود.

### الف) پرینترهای لیبل‌زن (Label Printers)

  * پشتیبانی از پروتکل‌های استاندارد `ZPL II` (برای Zebra) و `TSPL` (برای مدل‌های اقتصادی).
  * امکان تنظیم دما (Darkness) و سرعت چاپ (Speed) از داخل نرم‌افزار.

### ب) هندهلدها و PDA (موبایل کامپیوترها)

  * اپلیکیشن موبایل تابان روی دستگاه‌های اندرویدی صنعتی (مثل برندهای Chainway یا Urovo) نصب می‌شود.
  * این دستگاه‌ها دارای ماژول سخت‌افزاری بارکدخوان و آنتن UHF هستند.
  * اپلیکیشن مستقیماً با SDK سخت‌افزار در ارتباط است (نه دوربین گوشی).

-----

## ۶. سناریوهای کاربردی (Use Cases)

### سناریوی ۱: اموال‌گردانی رعدآسا (با RFID)

جمعدار وارد اتاق کنفرانس می‌شود. ۲۰ صندلی و ۱ میز کنفرانس و ۱ ویدئو پروژکتور در اتاق است.

1.  ماشه هندهلد RFID را فشار می‌دهد.
2.  در عرض ۳ ثانیه، تمام ۲۲ تگ موجود در اتاق خوانده می‌شوند (حتی آن‌هایی که زیر میز چسبیده‌اند).
3.  سیستم لیست خوانده شده را با "لیست دفتری اتاق" مقایسه می‌کند.
4.  پیام می‌دهد: *"تیک سبز\! همه اموال موجودند."*

### سناریوی ۲: شناسنامه دیجیتال (با QR Code)

مهندس تعمیرات جلوی یک دیزل ژنراتور ایستاده است. نمی‌داند آخرین بار کی روغن آن عوض شده.

1.  گوشی موبایلش را درمی‌آورد.
2.  QR Code روی دستگاه را اسکن می‌کند.
3.  لینک باز می‌شود و مستقیماً به صفحه "کارت دارایی" در ERP تابان می‌رود (نیاز به لاگین دارد).
4.  تب "تعمیرات" را می‌بیند و تاریخچه را چک می‌کند.

-----

## ۷. ملاحظات فنی برای توسعه‌دهندگان (Developer Notes)

### الف) زبان ZPL (Zebra Programming Language)

برای چاپ سریع و با کیفیت در تیراژ بالا، نباید عکس (Image) بسازیم و به پرینتر بفرستیم. باید کد خام ZPL تولید کنیم.

  * **مزیت:** سرعت فوق‌العاده بالا، شفافیت متن و بارکد.
  * **مثال کد:**
    ```zpl
    ^XA
    ^FO50,50^ADN,36,20^FDMinistry of Power^FS
    ^FO50,100^BQN,2,10^FDQA,IT-1403-005^FS
    ^XZ
    ```

### ب) نگاشت Hex (RFID Hex Encoding)

چیپ‌های RFID معمولاً حافظه ۹۶ بیتی (یا ۱۲۸ بیتی) دارند و فقط هگزادسیمال قبول می‌کنند.

  * توسعه‌دهنده باید الگوریتمی بنویسد که `AssetID` (مثلاً ۱۰۰۵) را به یک رشته هگز یونیک تبدیل کند و ترجیحاً یک پیشوند شرکتی (Company Prefix) به آن اضافه کند تا با اموال همسایه تداخل نداشته باشد.

### ج) امنیت لینک (QR URL Security)

لینکی که در QR قرار می‌دهید نباید عمومی باشد.

  * **غلط:** `taban-erp.com/asset/1005` (اگر عمومی باشد، هر کسی اسکن کند اطلاعات محرمانه سازمان را می‌بیند).
  * **صحیح:** لینک باید به صفحه لاگین هدایت شود یا از یک توکن موقت با دسترسی محدود استفاده کند.

-----

## ۸. پرسش‌های متداول (FAQ)

**س: آیا می‌توانیم از پرینتر معمولی (A4) استفاده کنیم؟**

  * **پاسخ:** بله، برای سازمان‌های کوچک. سیستم خروجی PDF می‌دهد که روی کاغذ لیبل A4 (شیت‌های چسب‌دار) قابل چاپ است. اما دوام این لیبل‌ها کم است و در محیط صنعتی زود خراب می‌شوند.

**س: اگر برچسب کنده شد یا خراب شد چه کنیم؟**

  * **پاسخ:** در سیستم دکمه‌ای به نام **«چاپ مجدد» (Reprint)** وجود دارد. این دستور همان پلاک قبلی را دوباره چاپ می‌کند. (پلاک جدید صادر نمی‌شود).

**س: تگ RFID روی فلز کار نمی‌کند؟**

  * **پاسخ:** تگ‌های کاغذی معمولی روی فلز کار نمی‌کنند (فلز امواج را جذب می‌کند). برای دارایی‌های فلزی باید حتماً از تگ‌های مخصوص **Mount-on-Metal** (که لایه فوم یا سرامیک دارند) استفاده کنید.