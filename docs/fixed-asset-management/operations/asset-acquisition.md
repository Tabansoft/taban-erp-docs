# روش‌های تحصیل دارایی ثابت (Acquisition Methods)

**مسیر دسترسی:** `دارایی ثابت > عملیات > تحصیل دارایی`
**نام فنی:** `AssetAcquisition`

## ۱. مقدمه و فلسفه وجودی

«تحصیل» (Acquisition) لحظه‌ای است که یک دارایی به صورت رسمی وارد چرخه عملیاتی و مالی سازمان می‌شود. این لحظه بسیار حیاتی است زیرا:

1.  **بهای تمام شده تاریخی (Historical Cost)** در این لحظه فریز می‌شود.
2.  **تاریخ شروع استهلاک** معمولاً از این تاریخ (یا ماه بعد) آغاز می‌گردد.
3.  **پلاک اموال** در این لحظه صادر می‌شود.

در ERP تابان، ماژول تحصیل به صورت **چند کاناله (Omni-Channel)** طراحی شده است تا تمام روش‌های ورود دارایی را پوشش دهد.

---

## ۲. انواع روش‌های تحصیل (Acquisition Channels)

سیستم ۵ روش استاندارد برای ایجاد دارایی دارد:

### ۲-۱. تحصیل از طریق انبار (From Inventory / Goods Issue)
**کاربرد:** رایج‌ترین روش برای تجهیزات اداری، ابزارآلات و وسایل نقلیه که ابتدا توسط انبار خریداری و رسید می‌شوند.

* **سناریو:** خرید ۱۰ عدد لپ‌تاپ توسط تدارکات.
* **جریان داده:**
    1.  تدارکات کالا را می‌خرد -> انبار «رسید» می‌کند (موجودی انبار: ۱۰ عدد).
    2.  واحد IT درخواست کالا می‌دهد -> انبار «حواله مصرف» می‌زند.
    3.  **تریگر سیستم:** سیستم تشخیص می‌دهد کالا "دارایی" است. به جای اینکه هزینه شود، فرم "تحصیل دارایی" باز می‌شود.
* **سند حسابداری (اتوماتیک):**
    * **بدهکار:** دارایی ثابت (۱۲۱۰۱)
    * **بستانکار:** موجودی کالا (۱۱۴۰۱)

### ۲-۲. خرید مستقیم (Direct Purchase / AP Invoice)
**کاربرد:** برای دارایی‌هایی که ماهیت فیزیکی قابل انبارش ندارند (زمین، ساختمان، نرم‌افزار، سرقفلی) یا مستقیماً در محل نصب می‌شوند.

* **سناریو:** خرید یک قطعه زمین یا لایسنس نرم‌افزار ERP.
* **جریان داده:**
    1.  فاکتور خرید مستقیماً در ماژول حسابداری/تدارکات ثبت می‌شود (بدون گردش انبار).
    2.  در هدر فاکتور، نوع خرید "دارایی ثابت" انتخاب می‌شود.
* **سند حسابداری:**
    * **بدهکار:** دارایی ثابت (۱۲۱۰۱)
    * **بستانکار:** حساب‌های پرداختنی / تامین‌کننده (۲۱۱۰۱)

### ۲-۳. دارایی در جریان تکمیل (Capitalization from CIP / Project)
**کاربرد:** پروژه‌های ساخت‌وساز یا خطوط تولید که ساخت آن‌ها زمان‌بر است.

* **سناریو:** ساخت یک سوله انبار که ۱ سال طول می‌کشد.
* **جریان داده:**
    1.  در طول سال، تمام هزینه‌ها (سیمان، آجر، حقوق کارگر) در کد حساب "دارایی در جریان تکمیل" جمع می‌شود.
    2.  در پایان پروژه، مدیر پروژه دکمه **«تکمیل دارایی» (Capitalize)** را می‌زند.
    3.  سیستم تمام هزینه‌های انباشته شده را جمع می‌کند و یک پلاک اموال "ساختمان" صادر می‌کند.
* **سند حسابداری:**
    * **بدهکار:** دارایی ثابت - ساختمان (۱۲۱۰۲)
    * **بستانکار:** دارایی در جریان تکمیل (۱۲۵۰۱)

### ۲-۴. تحصیل رایگان / اهدایی (Donation / Grant)
**کاربرد:** دریافت هدایا، موقوفات یا تجهیزات از سازمان‌های دیگر بدون پرداخت پول.

* **سناریو:** یک خیر مدرسه‌ساز، ۱۰ عدد کولر به مدرسه (سازمان دولتی) اهدا می‌کند.
* **چالش:** پولی پرداخت نشده، پس بهای تمام شده صفر است؟ خیر! طبق استاندارد باید به **«ارزش منصفانه» (Fair Value)** روز ثبت شود.
* **سند حسابداری (بخش خصوصی):**
    * **بدهکار:** دارایی ثابت
    * **بستانکار:** درآمد غیرعملیاتی (کمک‌های بلاعوض)
* **سند حسابداری (بخش دولتی):**
    * **بدهکار:** دارایی ثابت
    * **بستانکار:** تغییرات در ارزش خالص (درآمد اهدایی)

### ۲-۵. استقرار / موجودی اول دوره (Opening Balance)
**کاربرد:** هنگام راه‌اندازی نرم‌افزار تابان، برای ورود اطلاعات دارایی‌های قدیمی که سال‌ها پیش خریده شده‌اند.

* **ویژگی‌ها:**
    * تاریخ تحصیل در گذشته است (مثلاً سال ۱۳۹۵).
    * استهلاک انباشته تا امروز باید دستی وارد شود.
    * سند حسابداری صادر نمی‌شود (چون در سند افتتاحیه کل می‌آید) یا سند بالانس می‌خورد.

---

## ۳. جزئیات فرم تحصیل (The Acquisition Form)

این فرم ترکیبی از اطلاعات مالی و فیزیکی است.

| عنوان فیلد | نوع داده | الزامی؟ | شرح و منطق بیزینسی |
| :--- | :--- | :--- | :--- |
| **روش تحصیل** | Enum | بله | انتخاب یکی از ۵ روش بالا (تأثیر مستقیم روی سند حسابداری دارد). |
| **تاریخ تحصیل** | Date | بله | تاریخی که دارایی "آماده بهره‌برداری" شده است. مبنای شروع استهلاک. |
| **بهای تمام شده** | Money | بله | جمع مبلغ خرید + حمل + نصب + راه‌اندازی + عوارض گمرکی. |
| **تامین‌کننده** | FK | شرطی | در روش "خرید مستقیم"، نام فروشنده برای ردیابی گارانتی ثبت می‌شود. |
| **شماره سند مرجع** | String | خیر | شماره فاکتور، شماره حواله انبار یا شماره پروژه. |
| **ارزش اسقاط** | Money | خیر | پیش‌بینی اینکه در پایان عمر چقدر می‌ارزد (مؤثر در فرمول استهلاک). |

---

## ۴. سناریوهای کاربردی (Use Cases)

### سناریوی ۱: هزینه‌های پس از تحصیل (Subsequent Costs)
**سوال:** یک دستگاه پرس خریدیم (۱۰۰ میلیون). یک ماه بعد ۵ میلیون هزینه "نصب و فونداسیون" دادیم. این ۵ میلیون هزینه است یا دارایی؟

* **منطق تابان:** طبق استاندارد حسابداری، تا زمانی که دستگاه راه نیفتاده، تمام هزینه‌ها باید **Capitalize** شوند (به بهای دارایی اضافه شوند).
* **عملیات:** کاربر فرم "تحصیل تکمیلی" (Acquisition Adjustment) را باز می‌کند و ۵ میلیون را به پلاک قبلی اضافه می‌کند.
* **نتیجه:** بهای تمام شده دارایی می‌شود ۱۰۵ میلیون تومان.

### سناریوی ۲: خرید مجموعه‌ای (Bundle Purchase)
یک ست مبلمان اداری (شامل ۱ میز و ۴ صندلی) در یک فاکتور به مبلغ ۲۰ میلیون خریده شده است.

* **چالش:** ما ۵ پلاک اموال می‌خواهیم، اما ۱ قیمت کل داریم.
* **راهکار:** سیستم تابان قابلیت **«تسهیم هزینه» (Cost Allocation)** دارد.
    * کاربر ۵ قلم کالا ایجاد می‌کند.
    * مبلغ ۲۰ میلیون را وارد می‌کند.
    * سیستم می‌پرسد: "تسهیم بر چه اساس؟" (تعداد مساوی / یا وزنی).
    * اگر مساوی باشد: هر قلم ۴ میلیون تومان ثبت می‌شود.

---

## ۵. تعامل با سایر بخش‌ها (Integration)

1.  **ارتباط با بودجه (بخش دولتی):**
    * قبل از اینکه فرم تحصیل ذخیره شود، سیستم چک می‌کند: *"آیا برای سرفصل خرید ماشین‌آلات، اعتبار باقی‌مانده است؟"*
    * اگر بودجه نباشد، سیستم خطای بازدارنده (Hard Stop) می‌دهد.

2.  **ارتباط با پلاک‌دهی (Tagging):**
    * به محض زدن دکمه ذخیره، سیستم به تنظیمات "گروه دارایی" نگاه می‌کند و پلاک بعدی را رزرو و چاپ می‌کند.

---

## ۶. ملاحظات فنی برای توسعه‌دهندگان (Developer Notes)

### الف) قفل تاریخ (Date Lock)
سیستم نباید اجازه دهد تاریخ تحصیل در "دوره مالی بسته شده" ثبت شود.

* *مثال:* الان در سال ۱۴۰۳ هستیم. کاربر نباید بتواند دارایی جدیدی با تاریخ ۱۴۰۱ ثبت کند (مگر در حالت استقرار)، چون حساب‌های ۱۴۰۱ بسته شده است.

### ب) نگهداری ارز (Multi-Currency)
اگر دارایی از خارج خریداری شده (مثلاً ۱۰,۰۰۰ یورو):

* باید **نرخ ارز در روز تحصیل** در دیتابیس ذخیره شود.
* تمام گزارشات حسابداری به "ریال" است، اما در کارت دارایی باید "بهای ارزی" هم نگهداری شود تا در صورت نیاز به "تجدید ارزیابی ارزی" (طبق استاندارد ۱۱) استفاده شود.

### ج) دیاگرام پیشنهادی جریان داده



---

## ۷. پرسش‌های متداول (FAQ)

**س: اگر دارایی را قسطی بخریم، آیا بهره اقساط جزو بهای دارایی است؟**

* **پاسخ:**
    * **استاندارد ایران:** خیر، هزینه‌های تأمین مالی معمولاً "هزینه دوره" هستند (مگر در دارایی‌های واجد شرایط خاص مثل ساخت نیروگاه).
    * **سیستم تابان:** به صورت پیش‌فرض، بهره را جدا می‌کند. اما اگر کاربر بخواهد، می‌تواند از طریق "تحصیل تکمیلی" بهره را به دارایی اضافه کند.

**س: تخفیفات نقدی خرید چه می‌شود؟**

* **پاسخ:** بهای تمام شده باید **«خالص»** ثبت شود. یعنی (قیمت کالا - تخفیف تجاری). سیستم تابان مبلغ نهایی فاکتور را می‌خواند.

**س: مالیات بر ارزش افزوده (VAT) چطور؟**

* **پاسخ:**
    * اگر شرکت بتواند VAT را پس بگیرد (اعتبار مالیاتی) -> جزو بهای دارایی **نیست**.
    * اگر شرکت معاف از مالیات باشد (نتواند پس بگیرد) -> VAT به بهای دارایی **اضافه می‌شود**.
    * *این لاجیک بر اساس "گروه مالیاتی" شرکت در تنظیمات تعیین می‌شود.*