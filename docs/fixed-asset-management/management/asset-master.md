# کارت دارایی (Asset Master Data)

**مسیر دسترسی:** `دارایی ثابت > مدیریت دارایی‌ها > کارت دارایی`
**نام فنی:** `AssetMaster`

## ۱. مقدمه و فلسفه وجودی

کارت دارایی، **«پرونده جامع»** و **«منبع حقیقت» (Single Source of Truth)** برای هر قلم دارایی در سازمان است.
این فرم صرفاً یک صفحه برای نمایش اطلاعات نیست؛ بلکه یک **«داشبورد زنده»** است که وضعیت مالی، فیزیکی و فنی دارایی را در لحظه نشان می‌دهد.

در ERP تابان، کارت دارایی بر اساس اصل **۳۶۰ درجه** طراحی شده است:

1.  **چهره مالی:** چقدر خریدیم؟ چقدر می‌ارزد؟ (برای حسابدار)
2.  **چهره فیزیکی:** کجاست؟ دست کیست؟ (برای جمعدار)
3.  **چهره فنی:** مدلش چیست؟ کی سرویس شده؟ (برای مهندس فنی)

---

## ۲. آناتومی کارت دارایی (Structure & Tabs)

این فرم به دلیل حجم بالای اطلاعات، به چند زبانه (Tab) تقسیم می‌شود.

### ۲-۱. سربرگ (Header) - اطلاعات هویتی
این بخش همیشه ثابت است و تغییر نمی‌کند.

| عنوان فیلد | شرح و منطق بیزینسی |
| :--- | :--- |
| **شماره پلاک (Asset Tag)** | شناسه منحصر‌به‌فرد روی برچسب (مثلاً `IT-1403-005`). لینک اصلی به دنیای فیزیکی. |
| **نام دارایی** | عنوان گویا (مثلاً: لپ‌تاپ ایسوس مدل ZenBook). |
| **گروه دارایی** | لینک به درختواره (مثلاً: تجهیزات رایانه‌ای). *بسیاری از فیلدها را از اینجا به ارث می‌برد.* |
| **وضعیت (Status)** | وضعیت چرخه عمر: `فعال`، `راکد`، `تحت تعمیر`، `آماده فروش`، `اسقاط شده`. |
| **بارکد/سریال** | شماره سریال کارخانه سازنده (S/N) جهت ردیابی گارانتی. |
| **شناسه سادا** | **(مخصوص دولتی)** کد ۱۴ رقمی اموال دولتی که باید به وزارت دارایی گزارش شود. |

---

### ۲-۲. تب مالی و تحصیل (Financial & Acquisition)
اطلاعات ریالی که از "فرم تحصیل" آمده است.

| عنوان فیلد | نوع | شرح |
| :--- | :--- | :--- |
| **تاریخ تحصیل** | Date | روزی که مالک آن شدیم. |
| **تاریخ شروع استهلاک** | Date | معمولاً همان تاریخ تحصیل یا اول ماه بعد (قابل تنظیم). |
| **بهای تمام شده (Cost)** | Money | مبلغ خرید + هزینه‌های نصب. (این عدد ثابت است مگر تجدید ارزیابی شود). |
| **تامین‌کننده** | Link | فروشنده کالا (جهت خدمات پس از فروش). |
| **شماره سند خرید** | Link | لینک به فاکتور خرید یا سند حسابداری تحصیل. |

---

### ۲-۳. تب استهلاک و ارزش‌ها (Depreciation & Values)
این بخش "موتور محاسباتی" کارت است. اگر سازمان چند دفتری باشد، این تب به صورت گرید (جدول) نمایش داده می‌شود.



**ستون‌های جدول برای هر دفتر:**

1.  **نام دفتر:** (مثلاً دفتر مالیاتی).
2.  **روش استهلاک:** (مثلاً نزولی ماده ۱۴۹). *به ارث رسیده از طبقه دارایی.*
3.  **عمر مفید:** (مثلاً ۱۰ سال).
4.  **نرخ:** (مثلاً ۲۵٪).
5.  **ارزش دفتری لحظه‌ای (NBV):** `بهای تمام شده - استهلاک انباشته`. *این عدد زنده است.*
6.  **استهلاک انباشته:** کل پولی که تا امروز مستهلک شده.
7.  **هزینه سال جاری:** استهلاک امسال چقدر بوده؟

---

### ۲-۴. تب استقرار و مسئولیت (Location & Custody)
چه کسی پاسخگوی این دارایی است؟

| عنوان فیلد | شرح |
| :--- | :--- |
| **واحد جمعداری** | واحد سازمانی مسئول (مثلاً جمعداری مرکزی). |
| **محل استقرار** | آدرس فیزیکی دقیق (ساختمان A، طبقه ۲، اتاق ۲۰۵). |
| **تحویل گیرنده (Custodian)** | کارمندی که دارایی را تحویل گرفته (لینک به ماژول HR). |
| **مرکز هزینه (Cost Center)** | **حیاتی برای حسابداری.** هزینه استهلاک به پای کدام واحد نوشته شود؟ (مثلاً واحد فروش). |

> **نکته امنیتی:** این تب معمولاً قفل است و فقط از طریق "فرم نقل و انتقال" تغییر می‌کند تا تاریخچه (History) حفظ شود.

---

### ۲-۵. تب مشخصات فنی (Technical Specs)
این تب کاملاً **پویا (Dynamic)** است و بر اساس "گروه دارایی" تغییر می‌کند.

* اگر گروه "خودرو" باشد -> فیلدهای: شماره شاسی، شماره موتور، نوع سوخت، رنگ.
* اگر گروه "ملک" باشد -> فیلدهای: پلاک ثبتی، متراژ عرصه، متراژ اعیان.

---

### ۲-۶. تب اجزاء (Components) - استاندارد IFRS
برای دارایی‌های پیچیده که از چند بخش تشکیل شده‌اند (Component Accounting).

* **دارایی والد:** کامیون ولوو (پلاک ۱۰۰).
* **اجزاء:**
    * شاسی (پلاک ۱۰۰-۱) -> عمر ۲۰ سال.
    * موتور (پلاک ۱۰۰-۲) -> عمر ۵ سال.
    * لاستیک (پلاک ۱۰۰-۳) -> عمر ۲ سال.

---

## ۳. عملیات روی کارت (Actions)

در بالای فرم کارت دارایی، دکمه‌های عملیاتی وجود دارد که هر کدام یک فرآیند را استارت می‌زنند:

1.  **چاپ لیبل:** ارسال دستور چاپ به لیبل‌زن.
2.  **نقل و انتقال:** باز کردن فرم جابجایی (تغییر اتاق/فرد).
3.  **تغییر وضعیت:** مثلاً اعلام خرابی (تغییر وضعیت به "تحت تعمیر").
4.  **کاردکس گردش:** مشاهده تاریخچه تمام اتفاقات (کی خریده شد؟ کی تعمیر شد؟ کی جابجا شد؟).
5.  **تصاویر/پیوست:** آپلود عکس دارایی، اسکن فاکتور، کارت گارانتی.

---

## ۴. سناریوهای کاربردی (Use Cases)

### سناریوی ۱: ردیابی دارایی مفقوده (دولتی)
حراست یک مانیتور پیدا کرده که پلاک ندارد، اما شماره سریال پشت آن هست.

1.  کاربر وارد لیست کارت دارایی می‌شود.
2.  شماره سریال را سرچ می‌کند.
3.  کارت پیدا می‌شود: "مانیتور ال‌جی، تحویل آقای محمدی، اتاق ۱۰۲".
4.  سیستم نشان می‌دهد که این دارایی در وضعیت "فعال" است (یعنی نباید در راهرو رها شده باشد!).

### سناریوی ۲: هشدار گارانتی (خصوصی)
مدیر فنی می‌خواهد بداند گارانتی کدام سرورها ماه آینده تمام می‌شود.

1.  در کارت دارایی، فیلد "تاریخ پایان گارانتی" (از تب فنی) پر شده است.
2.  گزارشی می‌گیرد از دارایی‌هایی که `WarrantyDate < NextMonth` است.

---

## ۵. تعامل با سایر بخش‌ها (Integration)

1.  **با تعمیرات (Maintenance):**
    * در کارت دارایی، دکمه "تاریخچه تعمیرات" وجود دارد که لیست تمام Work Orderهای صادر شده برای این دستگاه را از ماژول نت می‌خواند.

2.  **با بیمه:**
    * فیلد "شماره بیمه‌نامه" و "تاریخ انقضا" در کارت دارایی، به ماژول قراردادها لینک است.

---

## ۶. ملاحظات فنی برای توسعه‌دهندگان (Developer Notes)

### الف) تاریخچه زمانی (Temporal Data / Audit Log)
کارت دارایی **نباید** فقط آخرین وضعیت را نگه دارد. ما نیاز داریم بدانیم "در تاریخ ۱ خرداد، این دارایی دست چه کسی بود؟".

* **راهکار:** استفاده از جدول `AssetHistory` یا ویژگی `Temporal Tables` در SQL Server. هر تغییری در فیلدهای کلیدی (محل، مسئول، مرکز هزینه) باید یک ورژن جدید در تاریخچه بسازد.

### ب) همزمانی (Concurrency)
اگر دو جمعدار هم‌زمان بخواهند یک دارایی را ویرایش کنند (مثلاً یکی محل را عوض کند، دیگری مسئول را)، سیستم باید از مکانیزم `Optimistic Locking` (چک کردن ورژن رکورد) استفاده کند تا تغییرات یکدیگر را بازنویسی نکنند.

### ج) ایندکس‌گذاری (Indexing)
چون جستجو روی این جدول بسیار زیاد است (با پلاک، با نام، با سریال، با تحویل‌گیرنده)، ایندکس‌های دیتابیس باید روی این ستون‌ها بهینه باشند.

---

## ۷. پرسش‌های متداول (FAQ)

**س: آیا می‌توانم نام دارایی را بعد از پلاک‌کوبی عوض کنم؟**

* **پاسخ:** بله، نام و توضیحات قابل ویرایش هستند. اما فیلدهای مالی (مثل بهای تمام شده) قفل هستند و فقط با "سند تعدیل" تغییر می‌کنند.

**س: اگر یک دارایی دزدیده شود، کارت آن را حذف کنیم؟**

* **پاسخ:** **هرگز!** در سیستم‌های مالی چیزی حذف نمی‌شود. شما وضعیت آن را به **«مفقود شده»** تغییر می‌دهید. دارایی همچنان در سیستم هست اما استهلاک آن متوقف می‌شود و در لیست اموال‌گردانی با رنگ قرمز نمایش داده می‌شود.

**س: شناسه سادا (دولتی) را از کجا بیاوریم؟**

* **پاسخ:** این شناسه توسط وب‌سرویس وزارت دارایی یا فایل اکسل مرجع ارائه می‌شود. در ERP تابان، کاتالوگ سادا بارگذاری شده و کاربر فقط کالا را انتخاب می‌کند تا کد ۱۴ رقمی در کارت بنشیند.