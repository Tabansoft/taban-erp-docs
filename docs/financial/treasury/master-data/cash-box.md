# صندوق‌ها (Cash Boxes)

## ۱. تعریف

**صندوق (Cash Box)** در ERP تابان، یک موجودیت اصلی (Master Data) در ماژول خزانه‌داری است که برای مدیریت و ردیابی **هرگونه وجه نقد فیزیکی** تحت تملک یا کنترل سازمان به کار می‌رود.

این موجودیت یک **دفتر معین (Sub-Ledger)** برای حساب‌های نقد در ترازنامه (مانند "صندوق" یا "تنخواه گردان") عمل می‌کند. هر تراکنش ورودی یا خروجی از صندوق، علاوه بر ثبت در سابقه صندوق، منجر به صدور یک **سند حسابداری خودکار** در دفتر کل (GL) می‌شود.

## ۲. معماری و دسته‌بندی

موجودیتی به نام «صندوق» تمام موارد زیر را پوشش می‌دهد و تمایز آن‌ها از طریق **"نوع صندوق (Cash Box Type)"** صورت می‌گیرد:

  * **صندوق عملیاتی/فروش (Operational/POS Cash Box):**

      * **هدف:** دریافت و پرداخت‌های روزمره.
      * **مثال:** صندوق فروشگاه، صندوق پذیرش هتل، صندوق دریافت شهریه.
      * **گردش کار:** دریافت‌های مکرر، پرداخت‌های جزئی، و واریز دوره‌ای به بانک (EOD - End of Day Process).

  * **تنخواه گردان (Petty Cash):**

      * **هدف:** مدیریت هزینه‌های جزئی و فوری سازمان تحت یک سقف مشخص.
      * **مثال:** تنخواه دفتر مدیرعامل، تنخواه کارپردازی، تنخواه تعمیرات و نگهداری.
      * **گردش کار:** مبتنی بر **سیستم سقف ثابت (Imprest System)** است؛ یعنی شارژ اولیه، ثبت هزینه‌ها، و شارژ مجدد *معادل* هزینه‌های انجام شده برای رساندن موجودی به سقف تعیین شده.

  * **صندوق مرکزی (Central Cash Box):**

      * **هدف:** مدیریت وجوه نقد اصلی سازمان، معمولاً در خزانه مرکزی.
      * **مثال:** گاوصندوق اصلی شرکت.
      * **گردش کار:** دریافت وجوه از صندوق‌های عملیاتی، پرداخت‌های نقدی کلان (در صورت لزوم)، و نگهداری موجودی.

## ۳. یکپارچه‌سازی (Integration)

تعریف «صندوق» به تنهایی کافی نیست؛ ارزش آن در یکپارچگی با سایر بخش‌های ERP است:

  * **دفتر کل (General Ledger):** حیاتی‌ترین ارتباط. هر صندوق باید به یک **حساب معین منحصربه‌فرد** در GL متصل باشد. این حساب، بازتاب ریالی موجودی آن صندوق در ترازنامه است.
  * **حساب‌های دریافتنی (AR):** هنگامی که مشتری فاکتور خود را "نقدی" پرداخت می‌کند، وجه به یک صندوق (مثلاً صندوق فروش) واریز می‌شود.
  * **حساب‌های پرداختنی (AP):** پرداخت‌های نقدی به تأمین‌کنندگان (بسیار نادر، اما ممکن) یا پرداخت هزینه‌ها (بسیار رایج در تنخواه) از مبدأ صندوق ثبت می‌شود.
  * **مدیریت سازمانی (OM):** هر صندوق به یک **مکان عملیاتی** (Operating Unit) و یک **شخص مسئول (Custodian)** که کارمند تعریف شده در ماژول منابع انسانی است لینک می‌شود.

## ۴. فرم تعریف صندوق (Cash Box Definition)

این فرم، قلب تپنده ماژول است. فیلدها باید به صورت منطقی دسته‌بندی شوند:

**مسیر:** `خزانه‌داری > تعاریف پایه > مدیریت صندوق‌ها و تنخواه`

-----

### بخش ۱: اطلاعات عمومی (General)

| نام فیلد | توضیح | مثال |
| :--- | :--- | :--- |
| **نام صندوق (Name)** | نام کامل و توصیفی صندوق | `تنخواه گردان واحد بازرگانی` |
| **بنگاه اقتصادی** | (اجباری) شرکتی که مالک این وجه نقد است. | `شرکت اصلی تابان` |
| **مکان عملیاتی** | (اختیاری) محلی که صندوق در آن مستقر است. | `3500 -کارخانه ` |
| **وضعیت** | فعال / غیرفعال / مسدود (جهت صندوق گردانی) | `فعال` |

### بخش ۲: تنظیمات حسابداری (Accounting)

| نام فیلد | توضیح | مثال |
| :--- | :--- | :--- |
| **نوع صندوق** | (اجباری) منطق عملیاتی صندوق را تعیین می‌کند. | `تنخواه (Petty Cash)` |
| **ارز صندوق** | (اجباری) ارز پایه صندوق. (اگر ارزی باشد، فرآیند تسعیر لازم است) | `IRR` |
| **حساب معین (GL)** | (اجباری) **مهم‌ترین فیلد.** حساب معین اختصاصی این صندوق در دفتر کل. | `11020105 - تنخواه بازرگانی` |
| **حساب کسری صندوق (Shortage Account)** | (توصیه اکید) حساب هزینه‌ای برای ثبت مغایرت‌های *کسری*. | `63010010 - هزینه کسری صندوق` |
| **حساب سرک صندوق (Overage Account)** | (توصیه اکید) حساب درآمدی برای ثبت مغایرت‌های *سرک*. | `71010020 - درآمد سرک صندوق` |
| **ابعاد مالی پیش‌فرض** | (اختیاری) برای سادگی در ورود اطلاعات. | `مرکز هزینه: 3500` |

### بخش ۳: کنترل‌های تنخواه (Petty Cash Controls)

> **توجه:** این تب فقط زمانی فعال و اجباری می‌شود که «نوع صندوق» = «تنخواه (Petty Cash)» باشد.

| نام فیلد | توضیح | مثال |
| :--- | :--- | :--- |
| **سقف تنخواه (Imprest Amount)** | (اجباری) حداکثر مبلغی که این صندوق *باید* داشته باشد. | `50,000,000` |
| **آستانه هشدار شارژ** | درصدی از سقف که در صورت رسیدن موجودی به آن، سیستم هشدار شارژ می‌دهد. | `20%` (یعنی 10 میلیون) |
| **سقف هر هزینه (Max Expense Limit)** | حداکثر مبلغ مجاز برای *هر* سند هزینه ثبت شده از این تنخواه. | `5,000,000` |

-----

## ۵. فرآیندهای اصلی و گردش کار (Core Workflows)

### گردش کار ۱: تنخواه گردان (سیستم سقف ثابت - Imprest System)
این فرآیند بر اساس ثابت نگه داشتن موجودی حساب کل تنخواه عمل می‌کند.

**گام اول: ایجاد و شارژ اولیه (Establish Fund):**

مدیر مالی «پرداخت» به مبلغ `سقف تنخواه` (مثلاً 50 م) از `حساب بانک` به `صندوق تنخواه` ثبت می‌کند.

**سند حسابداری (خودکار):**

* بدهکار: `11020105 - تنخواه بازرگانی` (50 م)
* بستانکار: `11010001 - بانک پاسارگاد` (50 م)

**نکته کنترلی:** از این لحظه، موجودی حساب کل `11020105` باید **همیشه** 50 م باقی بماند تا زمان تغییر سقف.

**گام دوم: ثبت هزینه‌ها (Expense Reporting - بدون سند دفتر کل):**

تنخواه‌گردان هزینه‌ها را (مثلاً مجموعاً 40 م) پرداخت می‌کند. او *فقط* «گزارش هزینه» (Expense Report) یا «رسیدهای هزینه» (Vouchers) را در سیستم ثبت می‌کند تا اسناد مثبته جمع‌آوری شوند.

**نکته:** هیچ سند حسابداری صادر نمی‌شود. موجودی حساب کل تنخواه تغییر نمی‌کند (همچنان 50 م است).

**گام سوم: شارژ مجدد (Replenishment):**

تنخواه‌گردان گزارش هزینه‌های خود (به مبلغ 40 م) را برای مدیر مالی ارسال می‌کند. مدیر مالی *دقیقاً* معادل هزینه‌های تأیید شده (40 م) را از `حساب بانک` مستقیماً به تنخواه‌گردان پرداخت می‌کند.

**سند حسابداری (خودکار - ثبت هزینه‌ها در این مرحله رخ می‌دهد):**

* بدهکار: `6201xxxx - هزینه ملزومات` (مثلاً 25 م)
* بدهکار: `6202xxxx - هزینه ایاب و ذهاب` (مثلاً 15 م)
* بستانکار: `11010001 - بانک پاسارگاد` (40 م)

**نتیجه:** موجودی فیزیکی تنخواه مجدداً به سقف 50 م بازگشت و حساب کل تنخواه نیز دست‌نخورده (50 م) باقی ماند.

### گردش کار ۲: صندوق عملیاتی (فروشگاه)

1.  **دریافت نقدی (Receipt):**
      * **عملیات:** مشتری کالا را خریده و مبلغ 1 م نقداً پرداخت می‌کند.
      * **سند حسابداری (خودکار - از ماژول فروش):**
          * بدهکار: `11020101 - صندوق فروشگاه 1` (1 م)
          * بستانکار: `41010001 - درآمد فروش` (1 م)
2.  **عملیات پایان روز (EOD - واریز به بانک):**
      * **عملیات:** صندوق‌دار در پایان روز، 30 م از وجوه را به بانک واریز می‌کند. یک "انتقال وجه" (Cash Transfer) از `صندوق فروشگاه 1` به `حساب بانک` ثبت می‌کند.
      * **سند حسابداری (خودکار):**
          * بدهکار: `11010001 - بانک پاسارگاد` (30 م)
          * بستانکار: `11020101 - صندوق فروشگاه 1` (30 م)

### گردش کار ۳: صندوق‌گردانی و ثبت مغایرت (Reconciliation)

این فرآیند *باید* در سیستم پشتیبانی شود.

1.  **شمارش فیزیکی:** مسئول صندوق، موجودی فیزیکی را می‌شمارد (مثلاً 4,500,000).
2.  **مقایسه با سیستم:** موجودی سیستمی (موجودی دفتر کل) در آن لحظه 4,550,000 است.
3.  **نتیجه:** 50,000 کسری وجود دارد.
4.  **عملیات در ERP:** کاربر فرم "صندوق‌گردانی/ثبت مغایرت" را باز می‌کند.
      * صندوق: `تنخواه بازرگانی`
      * موجودی سیستمی: `4,550,000`
      * موجودی واقعی: `4,500,000`
      * مغایرت: `(50,000)` (کسری)
5.  **ثبت سند (خودکار پس از تأیید):**
      * سیستم از حساب‌هایی که در "بخش ۲: تنظیمات حسابداری" تعریف کردیم استفاده می‌کند:
      * بدهکار: `63010010 - هزینه کسری صندوق` (50,000)
      * بستانکار: `11020105 - تنخواه بازرگانی` (50,000)
      * *نتیجه:* موجودی دفتر کل تنخواه با موجودی واقعی یکسان می‌شود (4,500,000).

-----

## ۵.  پرسش‌های متداول (FAQ)

**تفاوت اصلی "صندوق عملیاتی" و "تنخواه" در سیستم چیست؟**

هر دو صندوق هستند، اما منطق متفاوتی دارند. **صندوق عملیاتی** (مثل فروشگاه) ذاتاً *دریافت‌کننده* وجه است و موجودی آن متغیر است و در پایان روز به بانک واریز می‌شود. **تنخواه** ذاتاً *پرداخت‌کننده* هزینه است، بر اساس سقف ثابت (Imprest) کار می‌کند و هدفش رساندن موجودی به سقف تعیین شده از طریق شارژ مجدد است.

**چرا هر صندوق باید "حساب معین" جداگانه داشته باشد؟ آیا نمی‌توان همه را زیر یک حساب "صندوق" تعریف کرد؟**

این یک الزام کنترل داخلی است. اگر همه صندوق‌ها یک حساب معین داشته باشند، شما در ترازنامه فقط یک عدد کلی (مثلاً «موجودی صندوق: 500 م») می‌بینید. اما اگر هر صندوق (تنخواه الف، تنخواه ب، صندوق فروشگاه ۱) حساب معین جدا داشته باشد، می‌توانید مغایرت‌گیری، ردیابی و گزارش‌گیری را *به تفکیک هر صندوق* انجام دهید و ترازنامه شما شفافیت کامل (Drill-Down) تا سطح هر صندوق خواهد داشت.

**مسئول صندوق (Custodian) چه نقشی دارد؟**

این فرد، مسئول فیزیکی و قانونی وجوه آن صندوق است. در ERP، این فیلد کنترل‌های امنیتی را فعال می‌کند. مثلاً:

1.  فقط "مسئول" یا کاربران مجاز می‌توانند برای آن صندوق تراکنش ثبت کنند.
2.  در فرآیند صندوق‌گردانی، نام "مسئول" به عنوان تأیید کننده ثبت می‌شود.
3.  گزارش‌ها (مانند گردش صندوق) می‌توانند بر اساس مسئول فیلتر شوند.

**اگر در صندوق‌گردانی مغایرت (کسری یا سرک) داشتیم چه؟**

این اتفاق رایج است. به همین دلیل در فرم "تعریف صندوق"، فیلدهای **"حساب کسری"** و **"حساب سرک"** را تعریف کردیم. فرآیند "صندوق‌گردانی" در ERP باید به کاربر اجازه دهد موجودی واقعی را وارد کند و سیستم به طور خودکار سند مغایرت را (همانطور که در مثال گردش کار ۳ توضیح داده شد) صادر کند تا موجودی GL با موجودی واقعی برابر شود.

**آیا یک صندوق می‌تواند چند ارزی (Multi-Currency) باشد؟**

**توصیه اکید:** خیر. هر صندوق باید *فقط یک ارز* داشته باشد (همان فیلد "ارز صندوق"). اگر شما وجوه ریالی و یورویی دارید، باید *دو صندوق جداگانه* تعریف کنید: `صندوق مرکزی (ریالی)` و `صندوق مرکزی (یورویی)` که هر کدام به حساب معین ارزی یا ریالی خود متصل هستند. مدیریت چند ارز در یک صندوق فیزیکی، فرآیندهای حسابداری و تسعیر ارز را به شدت پیچیده و مستعد خطا می‌کند.