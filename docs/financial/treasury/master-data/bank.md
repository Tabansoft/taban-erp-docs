# بانک‌ها (Banks)

## ۱. مفهوم و تعریف (Concept & Definition)

موجودیت **«بانک» (Bank)** در سیستم ERP تابان، نشان‌دهنده یک **موسسه مالی/اعتباری مادر** است. این موجودیت، ریشه (Root) درخت اطلاعات بانکی است و خود به تنهایی شامل شعبه یا شماره حساب نیست.

**هدف اصلی:** استانداردسازی ورود اطلاعات.
به جای اینکه کاربران در سیستم نام‌های مختلفی مثل *"ملت"، "بانک ملت"، "موسسه اعتباری ملل"* را دستی تایپ کنند، باید از یک **لیست مرجع واحد** انتخاب کنند. این یکپارچگی برای گزارش‌گیری، مغایرت‌گیری و اعتبارسنجی شماره شبا (IBAN) حیاتی است.

### کاربرد این موجودیت کجاست؟
1.  **تعریف حساب‌های شرکت:** وقتی حساب جاری شرکت را تعریف می‌کنید، باید بگویید نزد کدام بانک است.
2.  **ثبت چک‌های دریافتی:** وقتی چکی از مشتری می‌گیرید، باید بانک صادرکننده آن را انتخاب کنید (مهم برای خواباندن به حساب).
3.  **اطلاعات حساب تأمین‌کنندگان:** برای واریز وجه (پایا/ساتنا) به حساب فروشندگان.

---

## ۲. مشخصات فنی فرم (Data Dictionary)

**مسیر دسترسی:** `خزانه‌داری > تعاریف پایه > بانک‌ها`

| نام فیلد (فارسی) | نام فیلد (Technical) | نوع داده | الزامی | توضیحات فنی و منطق سیستم |
| :--- | :--- | :--- | :--- | :--- |
| **شناسه سیستمی** | `ID` | Int (PK) | **Yes** | کلید اصلی (معمولاً Auto-increment). |
| **نام بانک** | `Name` | NVarChar(100) | **Yes** | نام کامل رسمی (مثلاً: `بانک ملت`). |
| **کد داخلی** | `Code` | Varchar(20) | **Yes** | کد کوتاه سیستم جهت جستجو (مثلاً: `MEL`). باید **یکتا (Unique)** باشد. |
| **کد بانک مرکزی** | `CentralBankCode` | Varchar(10) | No | **(نکته حرفه‌ای)** کدی که بانک مرکزی به بانک اختصاص داده (مثلاً `012` برای ملت). این کد در ساختار **شناسه صیادی** و **شماره شبا** استفاده می‌شود و برای اعتبارسنجی حیاتی است. |
| **کد سوئیفت** | `SwiftCode` | Varchar(11) | No | برای تراکنش‌های بین‌المللی (اختیاری). |
| **نام اختصاری/لاتین** | `Alias / EnName` | Varchar(50) | No | نام انگلیسی یا مخفف (مثلاً: `Mellat`). |
| **لینک اینترنت بانک** | `WebsiteURL` | URL | No | لینک ورود به سامانه بانکداری اینترنتی (برای دسترسی سریع حسابدار). |
| **لوگو/آیکون** | `LogoBlob` | Binary/URL | No | آیکون بانک جهت نمایش زیبا در لیست کارت‌های بانکی و گزارشات. |
| **رنگ سازمانی** | `ColorHex` | Varchar(7) | No | (اختیاری) کد رنگ برند بانک (مثلاً `#ED1C24` برای ملت) جهت نمایش در داشبوردها. |
| **وضعیت** | `IsActive` | Boolean | **Yes** | فعال/غیرفعال (برای بانک‌هایی که ادغام یا منحل می‌شوند). |

---

## ۳. ارتباطات و مدل داده (Relationships)

موجودیت بانک به تنهایی استفاده نمی‌شود و پدر (Parent) موجودیت‌های زیر است:

1.  **ارتباط با شعب (1:N):** هر «بانک» می‌تواند چندین «شعبه» (`BankBranch`) داشته باشد.
    * *مثال:* بانک ملی -> شعبه مرکزی، شعبه بازار.
2.  **ارتباط با حساب‌ها (1:N):** هر «بانک» می‌تواند میزبان چندین «حساب بانکی» (`BankAccount`) باشد.

---

## ۴. نکات پیاده‌سازی و داده‌های اولیه (Implementation Tips)

### الف) داده‌های اولیه (Seed Data)
برای تجربه کاربری بهتر (UX)، نرم‌افزار شما **نباید** با جدول بانک خالی تحویل مشتری شود. پیشنهاد می‌شود اسکریپتی تهیه کنید که لیست بانک‌های فعال کشور (حدود ۳۰ بانک و موسسه) را به همراه لوگو و کد بانک مرکزی، به صورت پیش‌فرض (Seed) در دیتابیس درج کند.

* **نمونه داده پیشنهادی:**
    * `Name`: بانک ملی ایران | `Code`: BMI | `CentralBankCode`: 017
    * `Name`: بانک ملت | `Code`: MEL | `CentralBankCode`: 012
    * `Name`: بانک پاسارگاد | `Code`: PAS | `CentralBankCode`: 057

### ب) اعتبارسنجی (Validation Rules)
1.  **یکتایی نام:** جلوگیری از تعریف دو بانک با نام یکسان.
2.  **فرمت کد:** اگر از کد بانک مرکزی استفاده می‌کنید، طول فیلد و عددی بودن آن کنترل شود.

### ج) حذف ممنوع (Integrity)
اگر تراکنشی (مثلاً یک چک) با «بانک ملت» در سیستم ثبت شده باشد، کاربر **نباید** بتواند بانک ملت را حذف کند. فقط می‌تواند آن را `IsActive = False` (غیرفعال) کند.

---

## ۵. سوالات متداول (FAQ)

**س: آیا برای هر شعبه باید یک بانک جدید تعریف کنم؟**
پ: خیر! در این فرم فقط نام کلی بانک (مثلاً "صادرات") تعریف می‌شود. شعبه‌های مختلف (مثل شعبه ونک، شعبه بازار) در فرم مجزایی به نام **«مدیریت شعب»** تعریف می‌شوند که زیرمجموعه همین بانک هستند.

**س: اگر دو بانک ادغام شدند (مثل بانک انصار در سپه) چه کنیم؟**
پ: بانک قدیمی (انصار) را حذف نکنید (چون سوابق چک‌های قدیمی از بین می‌رود). صرفاً تیک «فعال» آن را بردارید تا در فرم‌های جدید نمایش داده نشود.

**س: لوگوی بانک به چه دردی می‌خورد؟**
پ: در لیست حساب‌های بانکی و داشبورد مدیریتی، نمایش لوگوی بانک کنار موجودی حساب، خوانایی اطلاعات را برای مدیران بسیار بالا می‌برد (تشخیص بصری سریع‌تر از خواندن متن است).