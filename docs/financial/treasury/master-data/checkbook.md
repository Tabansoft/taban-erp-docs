# دسته چک‌ها (Checkbooks)

## ۱. مقدمه: مدیریت موجودی اسناد پرداخت

در سیستم‌های حسابداری سنتی، تمرکز فقط بر «مبلغ چک» و «تاریخ سررسید» بود. اما در سیستم ERP تابان، ما با دسته چک دقیقاً مشابه **«موجودی کالا در انبار»** برخورد می‌کنیم.

همان‌طور که شما باید بدانید دقیقاً چند عدد "لپ‌تاپ" در انبار دارید، باید دقیقاً بدانید چند برگ "چک سفید" در گاوصندوق دارید، کدام‌یک امضا شده، کدام‌یک خراب شده و کدام‌یک در دست مشتری است.

**این ماژول به سه سوال حیاتی پاسخ می‌دهد:**

1.  **کجاست؟** (فیزیک چک الان دست کیست؟ شرکت، بانک یا تأمین‌کننده؟)
2.  **چه وضعیتی دارد؟** (آیا صادر شده؟ آیا پاس شده؟ آیا باطل شده؟)
3.  **اعتبار قانونی آن چیست؟** (آیا در سامانه صیاد ثبت شده؟ آیا گیرنده آن را تایید کرده است؟)

با توجه به قوانین جدید بانک مرکزی (قانون صیاد) و ظهور چک‌های دیجیتال، این ماژول فقط یک دفترچه یادداشت نیست؛ بلکه **قلب کنترل خزانه‌داری** شماست.

-----

## ۲. انواع دسته چک (Checkbook Types)

در سیستم تابان، باید نوع ابزار پرداخت را در لحظه تعریف دسته چک مشخص کنید، زیرا رفتار سیستم برای هر کدام متفاوت است:

### الف) دسته چک قدیمی کاغذی (Old Paper)

  * **توصیف:** همان چک‌های قدیمی (معمولاً قبل از سال ۱۴۰۰) که الزامی برای ثبت در سامانه صیاد نداشتند.
  * **ویژگی:** فیلد «شناسه صیادی» برای این‌ها اختیاری است.
  * **کاربرد:** رو به انقراض هستند اما ممکن است هنوز در برخی شرکت‌ها برای ضمانت‌های قدیمی وجود داشته باشند.

### ب) دسته چک صیادی کاغذی (Sayad Paper)

  * **توصیف:** چک‌های طرح جدید (بنفش رنگ) که فیزیک کاغذی دارند.
  * **ویژگی:**
      * دارای شناسه ۱۶ رقمی یکتا هستند.
      * صدور فیزیکی کافی نیست؛ حتماً باید در اپلیکیشن بانکی ثبت شوند.
      * پشت‌نویسی (Endorsement) روی کاغذ ممنوع است.
  * **رفتار سیستم:** ورود شناسه ۱۶ رقمی برای تک‌تک برگه‌ها اجباری است.

### ج) دسته چک دیجیتال (Digital / E-Check)

  * **توصیف:** موجودیت کاملاً مجازی که در اپلیکیشن‌های بانکی و همراه بانک‌ها ارائه می‌شود. هیچ کاغذی وجود ندارد.
  * **ویژگی:**
      * امنیت بسیار بالا (امضای دیجیتال).
      * شماره سریال و شناسه صیادی در لحظه صدور توسط بانک تولید می‌شود.
  * **رفتار سیستم:** ما در سیستم یک "دسته چک مجازی" تعریف می‌کنیم تا تعداد مجوزهای صدور را کنترل کنیم. شماره سریال‌ها در لحظه صدور سند پرداخت وارد سیستم می‌شوند.

-----

## ۳. راهنمای تکمیل فرم تعریف دسته چک (Checkbook)

این فرم زمانی پر می‌شود که شما دسته چک جدیدی از بانک می‌گیرید یا بسته چک دیجیتال را در موبایل‌بانک فعال می‌کنید.

| عنوان فیلد | توضیحات و راهنمای تکمیل |
| :--- | :--- |
| **حساب بانکی (Bank Account)** | انتخاب حساب جاری متصل به این دسته چک. (سیستم فقط حساب‌های جاری را نشان می‌دهد). |
| **نوع دسته چک (Checkbook Type)** | یکی از سه نوع بالا (قدیمی، صیادی کاغذی، دیجیتال) را انتخاب کنید. |
| **عنوان دسته چک (Name)** | یک نام گویا بنویسید. <br> *مثال:* `صیادی بانک ملت - سری ۴۴ - دست خزانه‌دار` |
| **تاریخ دریافت (Receive Date)** | تاریخی که دسته چک را دریافت کردید. |
| **تعداد برگ (Leaf Count)** | تعداد کل برگه‌های چک (مثلاً ۵۰ برگ). برای چک دیجیتال، تعداد سقف مجاز صدور (مثلاً ۱۰ فقره). |
| **سریال شروع (Start Serial)** | **کاغذی:** شماره چاپ شده روی اولین برگ چک (مثلاً `۱۲۵۰۰۱`). <br> **دیجیتال:** عدد `0` یا خالی (چون سریال از قبل مشخص نیست). |
| **سریال پایان (End Serial)** | توسط سیستم محاسبه می‌شود (`شروع + تعداد - ۱`). |
| **وضعیت دسته چک (Status)** | وضعیت کلی دسته چک (فعال، مسدود شده، تمام شده). |

-----

## ۴. وضعیت‌های دسته چک (Checkbook Status)

این وضعیت بر کل دسته چک (همه برگه‌ها) حاکم است:

1.  **فعال (Active):** وضعیت پیش‌فرض. کاربران می‌توانند از برگه‌های خام این دسته چک استفاده کنند.
2.  **مسدود شده (Blocked):**
      * *کاربرد:* زمانی که دسته چک گم شده یا دزدیده شده است.
      * *رفتار سیستم:* تمام برگه‌های "خام" باقی‌مانده قفل می‌شوند و کسی نمی‌تواند سند صادر کند.
3.  **تمام شده (Depleted):**
      * *کاربرد:* زمانی که آخرین برگ چک استفاده شد.
      * *رفتار سیستم:* سیستم به صورت خودکار این وضعیت را اعمال می‌کند تا در لیست انتخاب دسته چک‌های فعال نمایش داده نشود.
4.  **بایگانی (Archived):**
      * *کاربرد:* برای دسته چک‌های قدیمی که تمام شده‌اند و نمی‌خواهید در لیست‌های دم‌دستی جلوی چشم باشند.

-----

## ۵. مدیریت برگه‌های چک و تحلیل وضعیت‌ها

پس از ذخیره فرم بالا، سیستم به تعداد برگه‌ها رکورد ایجاد می‌کند. با توجه به **تفاوت ماهیت "عملیات حسابداری" با "قوانین بانکی"** هر برگ چک دارای دو نوع وضعیت است.

### الف) وضعیت چک (Check Status) - دیدگاه داخلی

این وضعیت نشان می‌دهد چک در سیستم حسابداری ما چه مرحله‌ای را طی می‌کند.

| وضعیت | شرح |
| :--- | :--- |
| **خام (Unused)** | چک سفید است و هنوز روی آن چیزی نوشته نشده. |
| **صادر شده (Issued)** | چک در یک «سند پرداخت» استفاده شده و به طرف حساب داده شده است. |
| **نزد صندوق (On Hand)** | (مخصوص چک دریافتی) چک فیزیکی در شرکت موجود است. |
| **واگذار شده (Lodged)** | چک به بانک تحویل داده شده (در جریان وصول). |
| **پاس شده (Cleared)** | مبلغ چک از حساب کسر شده است. |
| **باطل شده (Voided)** | چک (فیزیکی یا دیجیتال) سوخت شده و قابل استفاده نیست. |

### ب) وضعیت صیادی (Sayad Status) - دیدگاه بانکی

این وضعیت نشان می‌دهد چک در دیتابیس بانک مرکزی (سامانه صیاد) چه وضعیتی دارد.

| وضعیت | شرح |
| :--- | :--- |
| **ثبت نشده (Not Registered)** | خطرناک\! چک صادر شده اما در بانک ثبت نشده. (فاقد اعتبار). |
| **ثبت اولیه (Registered)** | صادرکننده (ما) چک را در اپلیکیشن بانک ثبت کرده‌ایم. |
| **منتظر تایید (Pending)** | چک ثبت شده اما گیرنده هنوز تایید نکرده است. |
| **نهایی / تایید شده (Confirmed)** | گیرنده تایید کرده است. (وضعیت ایده‌آل). |
| **رد شده (Rejected)** | گیرنده چک را رد کرده است (باید اصلاح شود). |
| **عودت / انتقال (Transferred)** | مالکیت چک منتقل شده است. |

-----

## ۶. فیلدهای هر برگ چک

| نام فیلد | توضیحات |
| :--- | :--- |
| **شماره سریال (SerialNo)** | برای کاغذی از ابتدا پر است. برای دیجیتال در لحظه صدور پر می‌شود. |
| **شناسه صیادی (SayadID)** | کد ۱۶ رقمی (باید یکتا باشد). |
| **مبلغ (Amount)** | تا زمان صدور خالی است. |
| **تاریخ سررسید (DueDate)** | تا زمان صدور خالی است. |
| **در وجه (Payee)** | نام شخصی که چک برای او صادر می‌شود. |
| **وضعیت چک (Check Status)** | طبق جدول بالا (خام، صادر شده...). |
| **وضعیت صیادی (SayadStatus)** | طبق جدول بالا (ثبت نشده، نهایی...). |

-----

## ۷. سناریوهای عملیاتی (Scenarios)

### سناریو ۱: صدور چک دیجیتال (هماهنگی دستی)

1.  **عملیات بانکی:** حسابدار وارد همراه بانک می‌شود، گزینه صدور چک دیجیتال را می‌زند. بانک یک فایل PDF شامل شماره سریال `D-991` و شناسه صیادی `123...` می‌دهد.
2.  **عملیات سیستم:** حسابدار فرم «سند پرداخت» را باز می‌کند. روش پرداخت را `چک دیجیتال` انتخاب می‌کند.
3.  **ورود اطلاعات:** سیستم یک جای خالی برای سریال و شناسه باز می‌کند. حسابدار مقادیر `D-991` و `123...` را وارد می‌کند.
4.  **تنظیم وضعیت:** وضعیت صیادی را روی **«نهایی شده»** می‌گذارد (چون چک دیجیتال در لحظه صدور ثبت می‌شود).
5.  **ذخیره:** سیستم یکی از مجوزهای خام دسته چک دیجیتال را برداشته و اطلاعات را روی آن ذخیره می‌کند.

### سناریو ۲: رد چک توسط ذینفع (Rejection)

1.  **داستان:** شما چکی به مبلغ ۱۰ میلیون به فروشنده داده‌اید (وضعیت: صادر شده / ثبت اولیه).
2.  **رخداد:** فروشنده تماس می‌گیرد و می‌گوید: "تاریخ چک اشتباه است، من در سامانه صیاد رد کردم".
3.  **اقدام کاربر:**
      * به لیست چک‌ها می‌روید.
      * وضعیت صیادی را به **«رد شده»** تغییر می‌دهید.
      * نمی‌توانید چک را ویرایش کنید\! باید عملیات **«ابطال چک»** را انجام دهید (چک می‌سوزد).
      * یک چک جدید (برگه بعدی) صادر می‌کنید و اطلاعات صحیح را وارد می‌کنید.

### سناریو ۳: فراموشی ثبت صیاد (The Audit Alert)

1.  **داستان:** در پایان ماه، مدیر مالی گزارش «مغایرت صیاد» را می‌گیرد.
2.  **گزارش:** سیستم لیست تمام چک‌هایی را نشان می‌دهد که `Check Status = Issued` هستند اما `Sayad Status = Not Registered` است.
3.  **معنی:** این یعنی ۱۰ فقره چک دست مردم داده‌ایم که در بانک ثبت نکرده‌ایم و هر لحظه ممکن است آبروریزی شود\!
4.  **اقدام:** حسابدار باید سریعاً لیست را برداشته و در اپلیکیشن بانک ثبت کند و سپس در سیستم تیک آن‌ها را بزند.

### سناریو ۴: ابطال چک سفید (Voiding Unused Check)

1.  **داستان:** روی یک برگ چک کاغذی چای ریخته و غیرقابل استفاده شده است.
2.  **اقدام:** کاربر به فرم دسته چک می‌رود، برگ شماره `55` را پیدا کرده و دکمه **«ابطال»** را می‌زند.
3.  **وضعیت:** وضعیت چک به `Voided` تغییر می‌کند. وضعیت صیادی روی `Not Registered` می‌ماند (چون اصلاً به بانک نرسیده).

-----

## ۸. پرسش‌های متداول (FAQ)

**س: آیا می‌توانم شماره سریال چک را بعد از تعریف دسته چک تغییر دهم؟**
پ: تا زمانی که چک «خام» است، مدیر سیستم با دسترسی خاص می‌تواند آن را ویرایش کند. اما اگر چک صادر شده باشد، خیر.

**س: اگر دسته چک دیجیتال تمام شد چه کنم؟**
پ: باید در بانک درخواست بسته جدید بدهید و در سیستم یک «دسته چک جدید» تعریف کنید. نمی‌توانید به دسته چک قبلی برگه اضافه کنید.

**س: چرا باید شناسه صیادی را در سیستم وارد کنم وقتی به بانک وصل نیستیم؟**
پ:

1.  برای چاپ روی چک (اگر پرینتر چک دارید).
2.  برای گزارش‌گیری و جستجوی سریع چک.
3.  برای مغایرت‌گیری بانکی در آینده (تنها راه تطبیق تراکنش بانک با سیستم، همین شناسه است).

**س: اگر چکی را صادر کردیم و بعداً متوجه شدیم در صیاد اشتباه ثبت کرده‌ایم چه؟**
پ: اگر گیرنده هنوز تایید نکرده، در بانک اصلاح کنید و در سیستم هم ویرایش کنید. اگر گیرنده تایید کرده باشد، راهی جز این نیست که چک را پس بگیرید (استرداد)، در بانک باطل کنید و چک جدید صادر کنید.