# مدیریت صندوق‌های اسناد (چک و اوراق بهادار)

## ۱. مقدمه: صندوق اسناد چیست؟

در سیستم ERP تابان، ما مفهومی به نام **«صندوق اسناد» (Document Box)** داریم.
اگر در شرکت خود گاوصندوقی دارید که چک‌های مشتریان را در آن نگه می‌دارید، یا زونکنی دارید که چک‌های واگذار شده به بانک را در آن بایگانی می‌کنید، در نرم‌افزار ما به معادل دیجیتالی آن‌ها «صندوق اسناد» می‌گوییم.

**تفاوت با صندوق پول نقد:**

* **صندوق نقد:** فقط مبلغ پول را نشان می‌دهد (مثلاً: ۱۰ میلیون ریال).
* **صندوق اسناد:** دقیقاً نشان می‌دهد **چند برگ چک**، با **چه مبالغی** و **متعلق به چه کسانی** در آن قرار دارد.
---

## ۲. انواع صندوق‌هایی که باید تعریف کنید

برای اینکه نظم مالی داشته باشید، باید صندوق‌ها را بر اساس کاری که انجام می‌دهند دسته‌بندی کنید. هنگام تعریف صندوق جدید، باید **«نوع صندوق»** را مشخص کنید:

| نوع صندوق | کاربرد (زبان کاربر) | نام فنی (BoxType Enum) |
| :--- | :--- | :--- |
| **۱. عملیاتی (نزد صندوق)** | همان گاوصندوق اصلی شرکت. چک‌های تازه دریافت شده اینجا می‌روند. | `Operational` |
| **۲. در جریان وصول** | معادل حساب بانکی شماست. وقتی چک را به بانک می‌برید، باید به این صندوق منتقل شود. | `InCollection` |
| **۳. برگشتی** | صندوقی مجازی برای پیگیری چک‌های نکول شده (برگشتی). | `Bounced` |
| **۴. تضمینی** | مخصوص چک‌هایی که بابت ضمانت گرفته‌اید و قرار نیست نقد شوند. | `Guarantee` |

---

## ۳. آموزش تعریف صندوق جدید

برای شروع کار، به مسیر `خزانه‌داری > تعاریف پایه > صندوق‌های اسناد` رفته و دکمه **«جدید»** را بزنید.
لطفاً فیلدها را طبق جدول زیر پر کنید:

| عنوان فیلد در فرم | کد فنی (Field Name) | راهنمای تکمیل (Business Logic) |
| :--- | :--- | :--- |
| **کد صندوق** | `Code` | یک کد کوتاه و یکتا وارد کنید (مثلاً: `BOX-01`). |
| **نام صندوق** | `Name` | نامی گویا انتخاب کنید (مثلاً: `صندوق اسناد شعبه مرکزی`). |
| **بنگاه اقتصادی** | `LegalEntityID` | **(مهم)** مشخص کنید این صندوق متعلق به کدام شرکت حقوقی شماست. اسناد حسابداری در دفاتر این شرکت ثبت خواهد شد. |
| **مکان عملیاتی** | `OperatingUnitID` | مشخص کنید این صندوق فیزیکاً کجاست؟ (مثلاً: کارخانه کرج، دفتر فروش تهران). |
| **نوع صندوق** | `BoxType` | نوع عملکرد صندوق را از لیست انتخاب کنید (طبق جدول بالا). |
| **وابستگی بانکی** | `RelatedBankAccountID` | *فقط اگر نوع صندوق را «در جریان وصول» انتخاب کردید:* باید مشخص کنید این صندوق مربوط به کدام حساب بانکی است. |
| **حساب معین (GL)** | `GLAccountID` | کد حساب حسابداری مرتبط را انتخاب کنید. (اگر نمی‌دانید، از مدیر مالی بپرسید). |
| **ارز** | `CurrencyID` | نوع ارز چک‌هایی که در این صندوق قرار می‌گیرند (مثلاً: ریال). |
| **مسئول (جمعدار)** | `CustodianID` | نام کارمندی که کلید گاوصندوق دست اوست. |

---

## ۴. چرخه عملیات: چک‌ها چگونه جابجا می‌شوند؟

در سیستم تابان، شما مکان چک را دستی عوض نمی‌کنید؛ بلکه چک‌ها طی یک **فرآیند** جابجا می‌شوند. این فرآیند باعث می‌شود تا سیستم حسابداری خودکار انجام دهد.



در ادامه، مراحل زندگی یک چک ۵۰ میلیون ریالی را مرور می‌کنیم:

### مرحله اول: دریافت چک از مشتری
وقتی چک را از مشتری می‌گیرید و فرم «سند دریافت» را پر می‌کنید، چک به صورت خودکار وارد **«صندوق عملیاتی»** (گاوصندوق) می‌شود.

* **پشت صحنه حسابداری:**
    * **[بدهکار]:** حساب اسناد دریافتنی نزد صندوق (دارایی شما زیاد شد).
    * **[بستانکار]:** حساب مشتری (طلب شما کم شد).

### مرحله دوم: بردن چک به بانک (واگذاری)
وقتی موعد چک رسید و آن را به بانک بردید، باید در سیستم از منوی «واگذاری چک»، چک را انتخاب کرده و مقصد را **«صندوق در جریان وصول»** انتخاب کنید.

* **پشت صحنه حسابداری:**
    * **[بدهکار]:** حساب اسناد در جریان وصول (چک به بانک رفت).
    * **[بستانکار]:** حساب اسناد دریافتنی نزد صندوق (چک از شرکت خارج شد).

### مرحله سوم: تعیین تکلیف (پاس یا برگشت)
چند روز بعد، صورتحساب بانک را چک می‌کنید:

* **حالت الف) پول واریز شده:** دکمه **«اعلام وصول»** را می‌زنید.
    * *نتیجه:* چک از سیستم اسناد حذف شده و به موجودی بانک اضافه می‌شود.
    * *سند:* **[بدهکار]:** بانک / **[بستانکار]:** اسناد در جریان وصول.

* **حالت ب) چک برگشت خورده:** دکمه **«اعلام برگشت»** را می‌زنید.
    * *نتیجه:* چک به **«صندوق برگشتی»** می‌رود تا واحد حقوقی پیگیری کند.
    * *سند:* **[بدهکار]:** اسناد برگشتی / **[بستانکار]:** اسناد در جریان وصول.

---

## ۵. قوانین و بایدها (Business Rules)

برای اینکه سیستم و حسابداری شما دقیق بماند، لطفاً این قوانین را رعایت کنید:

1.  **کنترل موجودی:** شما نمی‌توانید چکی را از صندوقی خارج کنید که در آن وجود ندارد. (سیستم خطا می‌دهد).
2.  **مسیر درست:** نمی‌توانید چک را مستقیم از «گاوصندوق» به «صندوق برگشتی» ببرید. چک حتماً باید اول به بانک (در جریان وصول) رفته باشد تا بتواند برگشت بخورد.
3.  **تداخل ارزی:** نمی‌توانید یک چک دلاری را وارد صندوق ریالی کنید.
4.  **مالکیت:** امکان جابجایی چک بین صندوق‌های دو **بنگاه اقتصادی** مختلف وجود ندارد (چون دفاتر مالی آن‌ها جداست).

---

## ۶. گزارش‌هایی که این سیستم به شما می‌دهد

با استفاده صحیح از صندوق‌های اسناد، همیشه پاسخ این سوالات را دارید:

* **گزارش موجودی صندوق:** همین الان چند فقره چک و به چه مبلغی در گاوصندوق شرکت است؟
* **گزارش اسناد در راه:** چقدر چک نزد بانک داریم که هنوز پاس نشده؟ (برای پیش‌بینی نقدینگی).
* **انبارگردانی اسناد:** امکان چاپ لیست چک‌های هر صندوق برای شمارش فیزیکی و مغایرت‌گیری.