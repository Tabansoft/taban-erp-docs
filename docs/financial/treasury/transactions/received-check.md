# چک‌های دریافتی (Received Checks)

## ۱. تعریف

**مدیریت چک‌های دریافتی** در ERP تابان، ماژولی است که مسئولیت ردیابی چرخه حیات (Lifecycle) کامل یک برگ چک را از لحظه دریافت از مشتری تا لحظه نقد شدن (وصول) یا ابطال بر عهده دارد.

در سیستم‌های سنتی، چک صرفاً یک کاغذ بود که در گاوصندوق نگهداری می‌شد. اما در تابان، هر چک یک **موجودیت زنده** است که وضعیت آن مدام تغییر می‌کند (نزد صندوق ← واگذار شده به بانک ← وصول شده/برگشتی). این ماژول به شما کمک می‌کند تا بدانید دقیقاً چه میزان سرمایه در قالب چک دارید، سررسید آن‌ها کی فرا می‌رسد و هر چک اکنون در چه مرحله‌ای است.

## ۲. مفاهیم کلیدی و معماری

برای کار با این بخش، درک دو مفهوم زیر حیاتی است:

### الف) پورتفو یا سبد چک (Check Portfolio)
پورتفو به معنی یک **محفظه یا مکان** (فیزیکی یا مجازی) است که چک در آن نگهداری می‌شود. هر پورتفو به یک حساب معین خاص در حسابداری متصل است. انواع اصلی پورتفو عبارتند از:

* **پورتفوی نزد صندوق (On-Hand):** چک‌هایی که فیزیک آن‌ها در شرکت (گاوصندوق) موجود است.
* **پورتفوی در جریان وصول (In-Collection):** چک‌هایی که فیزیک آن‌ها به بانک تحویل داده شده (خوابانده شده) اما هنوز پول به حساب واریز نشده است.
* **پورتفوی چک‌های برگشتی (Bounced):** چک‌هایی که سررسید شده‌اند اما به دلیل عدم موجودی، توسط بانک برگشت خورده‌اند.

### ب) چرخه حیات چک (Check Lifecycle)
یک چک در سیستم تابان وضعیت‌های مختلفی می‌گیرد:

1.  **نزد صندوق (Received):** تازه دریافت شده.
2.  **در جریان وصول (Deposited):** به بانک واگذار شده.
3.  **وصول شده (Cleared):** تبدیل به پول نقد شده (پایان عمر چک).
4.  **برگشتی (Bounced):** نکول شده.
5.  **خرج شده (Endorsed):** به شخص ثالث (مثلاً تأمین‌کننده) واگذار شده.
6.  **استرداد شده (Returned):** به صاحبش (مشتری) پس داده شده.

## ۳. یکپارچه‌سازی (Integration)

این ماژول به شدت با سایر بخش‌های سیستم در ارتباط است تا از دوباره‌کاری جلوگیری کند:

* **حسابداری (GL):** هر تغییری در وضعیت چک (مثلاً از صندوق به بانک)، بلافاصله یک سند حسابداری خودکار صادر می‌کند تا ترازنامه شما به‌روز بماند.
* **فروش و حساب‌های دریافتنی (AR):** دریافت چک باعث بستانکار شدن حساب مشتری و تسویه فاکتورهای فروش او می‌شود.
* **خزانه‌داری (Cash Management):** وصول نهایی چک باعث افزایش موجودی «حساب بانکی» شرکت می‌شود.

## ۴. اجزای اطلاعاتی چک (Check Entity Fields)

هنگامی که یک چک را در سیستم ثبت می‌کنید (معمولاً از طریق فرم «سند دریافت»)، اطلاعات زیر ذخیره می‌شوند و حکم شناسنامه چک را دارند:

**مسیر مشاهده:** `خزانه‌داری > عملیات > چک‌های دریافتی`

| نام فیلد | اهمیت | توضیح | مثال |
| :--- | :--- | :--- | :--- |
| **شماره صیادی (Sayad ID)** | **حیاتی** | شناسه ۱۶ رقمی یکتا روی چک. سیستم اجازه ثبت دو چک با شناسه صیادی یکسان را نمی‌دهد. | `1234567890123456` |
| **شماره سریال** | بالا | شماره سریال قدیمی یا داخلی چک. | `556677/12` |
| **مبلغ چک** | بالا | ارزش ریالی چک. | `100,000,000` |
| **تاریخ سررسید (Due Date)** | بالا | تاریخی که چک باید نقد شود. مبنای گزارشات نقدینگی (Cash Flow). | `1403/05/20` |
| **بانک و شعبه** | متوسط | نام بانک صادرکننده چک (چک مشتری). | `بانک ملت - شعبه مرکزی` |
| **صاحب حساب (Account Owner)** | متوسط | نام شخصی که چک را امضا کرده است. | `آقای محمدی` |
| **پرداخت کننده (Payer)** | بالا | مشتری یا طرف حسابی که چک را به ما داده است (لینک به حساب تفصیلی). | `شرکت پخش البرز` |
| **وضعیت فعلی** | سیستمی | وضعیت جاری چک (نزد صندوق، وصول شده، ...). | `نزد صندوق` |
| **پورتفوی فعلی** | سیستمی | نام پورتفویی که چک هم‌اکنون در آن است. | `گاوصندوق تهران` |

-----

## ۵. فرآیندهای عملیاتی و گردش کار (Core Workflows)

مدیریت چک شامل سه مرحله اصلی است: تولد (دریافت)، سفر (واگذاری)، و سرانجام (وصول/برگشت).

### گردش کار ۱: دریافت چک از مشتری (Check Receipt)
چک چگونه وارد سیستم می‌شود؟

1.  **اقدام:** کاربر فرم **«سند دریافت جدید»** را باز می‌کند.
2.  **ورود اطلاعات:** در بخش روش پرداخت، گزینه «چک» را انتخاب کرده و اطلاعات چک (مبلغ، سررسید، شناسه صیادی) را وارد می‌کند.
3.  **ثبت:** با ثبت سند، چک ایجاد شده و وضعیت آن **«نزد صندوق»** می‌شود.
4.  **سند حسابداری خودکار:**

    $$Dr: \text{اسناد دریافتنی نزد صندوق}$$
    $$Cr: \text{حساب‌های دریافتنی - مشتری}$$

### گردش کار ۲: خواباندن چک به حساب (Deposit to Bank)
هنگامی که چک‌های داخل گاوصندوق را برمی‌دارید و به بانک می‌برید.

**مسیر:** `خزانه‌داری > عملیات چک > واگذاری به بانک`

1.  **انتخاب مبدأ و مقصد:**
    * پورتفوی مبدأ: `گاوصندوق دفتر مرکزی`
    * حساب مقصد (بانک): `بانک ملت - جاری`
2.  **انتخاب چک‌ها:** سیستم لیست چک‌های موجود در گاوصندوق را نشان می‌دهد. کاربر چک‌هایی که سررسیدشان نزدیک است را تیک می‌زند.
3.  **ثبت عملیات:** با زدن دکمه «واگذاری»، وضعیت چک‌ها به **«در جریان وصول»** تغییر می‌کند.
4.  **سند حسابداری خودکار:**
    $$Dr: \text{اسناد در جریان وصول - بانک ملت}$$
    $$Cr: \text{اسناد دریافتنی نزد صندوق}$$

### گردش کار ۳: تعیین تکلیف نهایی (Clearance / Bounce)
چند روز بعد، بانک وضعیت چک را مشخص می‌کند.

**مسیر:** `خزانه‌داری > عملیات چک > اعلام وصول/برگشت`

**سناریوی الف: وصول (پاس شدن)**
* کاربر چک مورد نظر را در لیست «در جریان وصول» پیدا کرده و دکمه **«وصول شد»** را می‌زند.
* **نتیجه:** موجودی بانک در سیستم افزایش می‌یابد و پرونده چک بسته می‌شود.
* **سند خودکار:**
    $$Dr: \text{موجودی نقد و بانک - بانک ملت}$$
    $$Cr: \text{اسناد در جریان وصول - بانک ملت}$$

**سناریوی ب: برگشت (عدم موجودی)**
* کاربر دکمه **«برگشت خورد»** را می‌زند.
* **نتیجه:** چک به پورتفوی «اسناد برگشتی» منتقل می‌شود تا تیم مالی پیگیری کند.
* **سند خودکار:**
    $$Dr: \text{اسناد برگشتی}$$
    $$Cr: \text{اسناد در جریان وصول - بانک ملت}$$

-----

## ۶. پرسش‌های متداول (FAQ)

**آیا می‌توانم چکی که «وصول شده» را دوباره به حالت «نزد صندوق» برگردانم؟**

خیر، به صورت مستقیم نمی‌توانید. اگر اشتباهی رخ داده (مثلاً اشتباهاً دکمه وصول را زده‌اید)، باید از فرآیند **«ابطال عملیات»** استفاده کنید تا سند حسابداری مربوطه معکوس شده و چک به وضعیت قبلی بازگردد. این کار برای حفظ یکپارچگی حسابداری ضروری است.

**چرا باید شناسه صیادی (۱۶ رقمی) را وارد کنم؟**

این یک الزام قانونی و کنترلی است. سیستم با استفاده از شناسه صیادی:
۱. جلوی ثبت تکراری یک چک را می‌گیرد.
۲. امکان استعلام وضعیت خوش‌حساب بودن صادرکننده را (در صورت اتصال به وب‌سرویس بانک مرکزی) فراهم می‌کند.
۳. در گزارش‌های مغایرت بانکی، تطبیق دقیق‌تری انجام می‌دهد.

**اگر بخواهم چک مشتری را مستقیماً به یک تأمین‌کننده بدهم (خرج کنم) چه باید کرد؟**

باید از فرم **«سند پرداخت»** استفاده کنید. در آنجا روش پرداخت را «خرج چک» انتخاب کنید. سیستم لیست چک‌های موجود در صندوق را به شما نشان می‌دهد تا یکی را انتخاب و به تأمین‌کننده واگذار کنید.

**تفاوت «واگذاری به بانک» با «وصول چک» چیست؟**

«واگذاری» یعنی فیزیک چک را به متصدی بانک تحویل داده‌اید (هنوز پول نشده). «وصول» یعنی بانک مبلغ چک را نقد کرده و به حساب شما واریز کرده است. در سیستم حسابداری، این دو مرحله باید تفکیک شوند تا اسناد «در راه» (Floating) مشخص باشند.